touch switch-docker-proxy.sh

```shell

#!/bin/bash

case "$1" in
    "user-shenyabo")
        PROXY="http://192.168.1.25:7890"
        ;;
    "user-changjiangming")
        PROXY="http://192.168.1.23:7890"
        ;;
    "default"|"")
        PROXY=""
        ;;
    *)
        echo "Usage: $0 {user-a|user-b|default}"
        exit 1
        ;;
esac

# 更新代理配置
cat > /tmp/docker-proxy.conf << EOF
[Service]
Environment="HTTP_PROXY=$PROXY"
Environment="HTTPS_PROXY=$PROXY"
Environment="NO_PROXY=localhost,127.0.0.1,docker-registry.example.com,.corp"
EOF

sudo mv /tmp/docker-proxy.conf /etc/systemd/system/docker.service.d/http-proxy.conf
sudo systemctl daemon-reload
sudo systemctl restart docker

echo "Docker proxy switched to: $PROXY"
```

设置执行权限：

sudo chmod +x /home/shenyabo/my-docker/switch-docker-proxy

使用案例：

sh /home/shenyabo/my-docker/switch-docker-proxy.sh user-shenyabo

sh /home/shenyabo/my-docker/switch-docker-proxy.sh user-changjiangming

```
sudo switch-docker-proxy user-shenyabo
sudo switch-docker-proxy user-changjiangming
sudo switch-docker-proxy default  # 清除代理
```

5. 验证配置

sudo systemctl show docker --property Environment
docker info | grep -i proxy

### 检查所有加载的配置

```
# 查看所有生效的环境变量
sudo systemctl show docker --property Environment

# 查看完整的服务配置
sudo systemctl cat docker

# 检查配置加载顺序
sudo systemd-analyze cat-config systemd/docker.service
```

### 检查特定配置是否生效

```
# 查看代理设置
docker info | grep -i proxy

# 测试网络连接
docker pull hello-world
```

```

```
