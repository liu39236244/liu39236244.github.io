# Docker Compose 使用自定义文件名启动

如果 Compose 配置文件不叫 `docker-compose.yml`，需要使用 `-f` 或 `--file` 参数指定配置文件。

## 1. 基本用法

```bash
# 使用 -f 参数指定配置文件
docker-compose -f 你的文件名.yml up -d

# 或者使用 --file 参数（效果相同）
docker-compose --file 你的文件名.yml up -d
```

## 2. 具体示例

假设您的配置文件叫 `gitlab-setup.yml`：

```bash
# 启动服务
docker-compose -f gitlab-setup.yml up -d

# 停止服务
docker-compose -f gitlab-setup.yml down

# 查看服务状态
docker-compose -f gitlab-setup.yml ps

# 查看日志
docker-compose -f gitlab-setup.yml logs -f

# 重启服务
docker-compose -f gitlab-setup.yml restart
```

## 3. 在您的 GitLab 场景中的应用

```bash
# 进入您的目录
cd /home/shenyabo/my-docker/gitlab

# 假设您的配置文件名为 gitlab-compose.yml
docker-compose -f gitlab-compose.yml up -d

# 查看启动日志
docker-compose -f gitlab-compose.yml logs -f gitlab
```

## 4. 使用多个 Compose 文件

您还可以组合多个配置文件：

```bash
# 使用基础配置和覆盖配置
docker-compose -f docker-compose.base.yml -f docker-compose.override.yml up -d

# 示例：GitLab 的不同环境配置
docker-compose -f gitlab-base.yml -f gitlab-dev.yml up -d
```

## 5. 完整的工作流程示例

```bash
# 1. 创建目录和配置文件
mkdir -p /home/shenyabo/my-docker/gitlab
cd /home/shenyabo/my-docker/gitlab

# 2. 创建配置文件（比如命名为 gitlab-config.yml）
cat > gitlab-config.yml << 'EOF'
version: '3'
services:
  gitlab:
    image: 'gitlab/gitlab-ce:latest'
    container_name: 'gitlab'
    restart: always
    hostname: 'localhost'
    environment:
      GITLAB_OMNIBUS_CONFIG: |
        external_url 'http://localhost'
    ports:
      - '80:80'
      - '443:443'
      - '22:22'
    volumes:
      - './config:/etc/gitlab'
      - './logs:/var/log/gitlab'
      - './data:/var/opt/gitlab'
EOF

# 3. 使用自定义文件名启动
docker-compose -f gitlab-config.yml up -d

# 4. 查看状态
docker-compose -f gitlab-config.yml ps

# 5. 查看日志
docker-compose -f gitlab-config.yml logs -f
```

## 6. 常用命令总结

```bash
# 启动服务
docker-compose -f 自定义文件名.yml up -d

# 停止并删除服务
docker-compose -f 自定义文件名.yml down

# 查看运行状态
docker-compose -f 自定义文件名.yml ps

# 查看服务日志
docker-compose -f 自定义文件名.yml logs

# 跟随日志输出
docker-compose -f 自定义文件名.yml logs -f

# 重启服务
docker-compose -f 自定义文件名.yml restart

# 停止服务（不删除）
docker-compose -f 自定义文件名.yml stop

# 启动已停止的服务
docker-compose -f 自定义文件名.yml start

# 重新构建并启动
docker-compose -f 自定义文件名.yml up -d --build
```

## 7. 环境变量简化方法

为了避免每次都输入 `-f` 参数，可以设置环境变量：

```bash
# 临时设置环境变量
export COMPOSE_FILE=gitlab-config.yml

# 然后就可以直接使用 docker-compose 命令
docker-compose up -d
docker-compose ps

# 或者将其添加到 ~/.bashrc 永久生效
echo "export COMPOSE_FILE=gitlab-config.yml" >> ~/.bashrc
source ~/.bashrc
```

## 8. 注意事项

- 使用相对路径时，路径是相对于执行命令的目录，不是配置文件的目录
- 卷挂载路径也是相对于执行命令的目录
- 建议在配置文件所在目录执行命令，或者使用绝对路径

这样您就可以灵活地使用任意文件名的 Docker Compose 配置文件了！
