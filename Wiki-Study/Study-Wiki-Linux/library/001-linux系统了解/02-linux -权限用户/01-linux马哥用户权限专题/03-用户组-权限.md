# 用户组-权限


## 前言



在日常开发过程中，linux 系统进行操作的时候，肯定是用的不同的用户，因为这样才能更好控制每个用户的权限；如果都用root 用户 那肯定会有很多问题的。


### 介绍安全3A

> 3A 安全机制

* 1 Authentication :认证 

你比如手机的指纹，电脑的账户民密码，虹膜解锁等等

* 2  Authorization:授权
    比如删除等操作，

* 3  Accouting|Audition :审计

    删了库你不得去查到低谁干的



### 用户User

* 1  令牌token,identity

![](assets/001/02/01/03-1615125952777.png)
        
* 2 Linux用户 ：Username/UID

* 3 管理员：root,0  ： 一般root id 为 0 

* 4 普通用户： 1-65535

但是 centos6 普通用户 id500开始 , centos7普通用户是1000开始

    系统用户：1-499 ， 1-999 （Centos7）
        对守护进程获取资源进行权限分配，给系统一些软件使用的；你比如构建nginx 服务，那么这些1-499  1-999 这些id 就从这里面取，给系统使用，并不是给咱们人用的
    登录用户：500+,1000+(Centos7)
        交互式登录


### 用户组


* 1 Linux组 Groupname/GID

* 3 管理员组 ： root,0 
    当然用户与组名 是可以有相同的，其实你在linux 中创建一个账号的时候，系统会默认也创建一个跟用户名同样的私有组，并把该用户加入进去。win 中则创建用户只是创建用户

* 4 普通组：
    系统组： 1-499 ， 1-999 （centos7）
    普通组： 500+ ， 1000+ （centos7）

> 1 就好比windows 系统中 可以用命令 ：net user 创建用户


![](assets/001/02/01/03-1615126795950.png)


win-组列表

![](assets/001/02/01/03-1615126843197.png)

win-中创建用户，则会加入到默认users组当中，win中是不允许同名的用户与组 这点是与linux 不一样的

![](assets/001/02/01/03-1615127347657.png)

win-删除用户：net user 用户名 /del, 删除

![](assets/001/02/01/03-1615127471308.png)


如果现在有个文件想要给张三 。李四授权可以命令挨个给权限，但是如果以后有更多用户加入进来那肯定也麻烦，所以用到组


## 安全上下文

> 1 linux 安全上下文

    运行中的程序：进程（process）
    以进程发起者的身份运行：
        root:/bin/cat
        mage:/bin/cat
    
> 2 进程所能访问资源的权限取决于进程的运行者的身份

![](assets/001/02/01/03-1615127911986.png)


> 3 累计权限：就是一个用户如果在多个组，而每个组对某个文件权限一样，那么则会累计多个组的权限，相当于取并集


![](assets/001/02/01/03-1615128048960.png)


## 组的类别

> 1 Linux 组的类别

    用户的主要组（primary group） 主组，必须要有一个主组，默认新增加的账户对应的组就是用户的主组，也可以设置为其他组作为主组
        用户必须属于一个且只有一个主组
        祖名同用户名，且仅包含一个用户，私有组
    用户的附加组(supplementary group)
        一个用户可以属于零个或者多个附加组
    



主组在什么地方用到呢？

![](assets/001/02/01/03-1615128609092.png)

![](assets/001/02/01/03-1615128552935.png)


> 2 查看用户组信息

![](assets/001/02/01/03-1615128825905.png)



## 用户和组的配置文件


> 1 Linux 用户和组的主要配置文件：

    /etc/passwd : 用户以及其属性信息 (名称、UID、主组ID等)
    /etc/group: 组及其属性信息
    /etc/shadow: 用户密码以及其相关属性
    /etc/gshadow:组密码以及其相关属性

> 2 看下 /etc/passwd 文件 

![](assets/001/02/01/03-1615129104496.png)


* 这里放上一个man 命令使用的博客地址[man 使用](https://www.cnblogs.com/chenmingjun/p/8352478.html)

![](assets/001/02/01/03-1615129293462.png)

列出passwd 文件的说明，放口令的文件，但是以前是方口令，但是普通用户都能访问得到的文件，那肯定不安全

![](assets/001/02/01/03-1615129556685.png)

存储格式是冒号隔开的7项


![](assets/001/02/01/03-1615131253439.png)

![](assets/001/02/01/03-1615131218875.png)


> 3 打开文件 


查看 

![](assets/001/02/01/03-1615130016501.png)


下面是 将文件中口令显示出来（当然是加密的）

![](assets/001/02/01/03-1615129896677.png)

还是改回去比较好

![](assets/001/02/01/03-1615129950145.png)


* 第三位是用户id ，这里也说明了 ，root 用户id 是0 ，所以假设你把王账号的用户id 设置为 0 ，吧root 用户id 设置为 非零，（改过之后需要重新
登录） 那么是不是身份就能改变了？（是的！是的！是的！）修改过后身份就改变了

<font color='red'>而且可以有多个用户id为0 ，只要userid 为0 那么就是管理员！！！</font>

但是要注意，如果都改为0 ，假设用底下的 wang 账号登录了。那么会显示配置文件中最上面id 为0 的用户名字，你用普通用户登录，但是whoami 就是root了 

![](assets/001/02/01/03-1615130572396.png)


* 但是如果改文件 改坏了，比如没有任何一个用户id为0 ，就是没有管理员，那么就会登录上了。

但是可以用单用户模式进行修改；

> 3 修改配置文件错误怎么办，单用户模式 修改 /etc/passwd

* 直接修改肯定是不行的

![](assets/001/02/01/03-1615130902047.png)

* 执行之后就可以修改了，然后就把改坏的再改回来

![](assets/001/02/01/03-1615130931212.png)


> 4 回归正题 ，看第四位 



第四位就是用户的描述信息，root 用户可能这里就是 root 字样表示为root 如果想手动添加描述可以用命令 ：chfn wang 

![](assets/001/02/01/03-1615131390472.png)

![](assets/001/02/01/03-1615131434274.png)

也可以直接用finger 查看用户信息

![](assets/001/02/01/03-1615131600497.png)

![](assets/001/02/01/03-1615131512301.png)


> 5 家目录


![](assets/001/02/01/03-1615131668291.png)

修改家目录如果目录不存在，则登陆之后会在 根目录

![](assets/001/02/01/03-1615132309255.png)

在把家目录换回正常，提示符也随正常了。那就是因为用户家目录其实对应的还有相应的配置文件

![](assets/001/02/01/03-1615132050986.png)

* 那么如果就是想修改怎么办


![](assets/001/02/01/03-1615132530917.png)

![](assets/001/02/01/03-1615132870878.png)
![](assets/001/02/01/03-1615132814913.png)


* 命令其实是吧 /etc/ 下所有的文件都复制过去了

删除刚才的复制的，重新创建给权限；命令该怎么写？    

![](assets/001/02/01/03-1615132915000.png)

命令： 
cp -r /etc/skel/.[`.]* /data/wang 

![](assets/001/02/01/03-1615132981260.png)


> 明天继续：https://www.bilibili.com/video/BV1bt411f7Bv?p=2

